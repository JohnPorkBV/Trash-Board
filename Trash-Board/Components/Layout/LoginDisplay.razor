@using Microsoft.AspNetCore.Components.Authorization
@using System.Security.Claims
@using TrashBoard.Services
@inject AuthenticationStateProvider AuthStateProvider
@inject CustomLocalizer<TrashBoard.Login> L
@rendermode InteractiveServer
@inject NavigationManager Nav

@if (authState is null)
{
    <p>Loading...</p>
}
else if (authState.User.Identity?.IsAuthenticated == true)
{
    var user = authState.User;
    <span>@user.Identity?.Name</span>

    @if (user.IsInRole("Admin"))
    {
        <span class="badge bg-danger ms-2">@L["Role_Admin"]</span>
        <a class="btn btn-danger" href="/admin/admin">@L["Role_Admin"]</a>
    }
    else if (user.IsInRole("Viewer"))
    {
        <span class="badge bg-info ms-2">@L["Role_Viewer"]</span>
    }
    <form method="post" action="/logout-handler">
        <button class="btn btn-logout mt-2" type="submit">@L["Title_Logout"]</button>
    </form>
}
else
{
    <a class="btn btn-primary" href="/login">@L["Title_Login"]</a>
    @* <a class="btn btn-primary" href="/register">@L["Title_Register"]</a> *@
}
<style>

    h1, h2, h3, h4, h5, h6 {
        color: #006400; /* Donkergroen */
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-weight: 600;
        margin-top: 1rem;
        margin-bottom: 0.5rem;
    }

    .btn-logout {
        background-color: blue !important; /* Bootstrap standaard rood */
        border-color: blue !important;
        color: white !important;
    }

        .btn-logout:hover {
            background-color: blue !important;
            border-color: blue !important;
            color: white !important;
        }

    .btn-logout {
        position: relative;
        top: -4px; /* schuift de knop 5 pixels omhoog, pas aan naar wens */
    }

    /* Admin-knop (btn-danger) focus- en klikstijl */
    .btn-danger:focus,
    .btn-danger:focus-visible {
        outline: none !important;
        border-color: #006400 !important; /* Donkergroen */
        box-shadow: 0 0 0 0.25rem rgba(0, 100, 0, 0.5) !important; /* Donkergroene glow */
    }

    /* Logout-knop focus- en klikstijl */
    .btn-logout:focus,
    .btn-logout:focus-visible {
        outline: none !important;
        border-color: #006400 !important; /* Donkergroen */
        box-shadow: 0 0 0 0.25rem rgba(0, 100, 0, 0.5) !important; /* Donkergroene glow */
    }


</style>
@code {
    private AuthenticationState? authState;

    protected override async Task OnInitializedAsync()
    {
        await L.InitializeAsync();
        authState = await AuthStateProvider.GetAuthenticationStateAsync();

    }
    private void Logout()
    {
        Nav.NavigateTo("/logout");
    }
}
